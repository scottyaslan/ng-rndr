{"version":3,"sources":["/source/c3_renderers.coffee","c3_renderers.min.js"],"names":["callWithJQuery","pivotModule","exports","module","require","define","amd","jQuery","c3","$","c3_renderers","makeC3Chart","chartOpts","pivotData","opts","agg","base","base1","base2","colKey","colKeys","columns","dataArray","datum","defaults","fullAggName","groupByTitle","h","hAxisTitle","headers","i","j","k","len","len1","len2","numCharsInHAxis","params","ref","renderArea","result","returnObject","rotationAngle","row","rowHeader","rowKey","rowKeys","title","titleText","tree2","vAxisTitle","val","x","y","localeStrings","vs","by","extend","size","width","window","innerWidth","height","innerHeight","type","getRowKeys","length","push","getColKeys","results","join","aggregatorName","valAttrs","colAttrs","rowAttrs","tree","parseFloat","format","value","getAggregator","isFinite","toPrecision","toFixed","style","text","axis","label","tick","rotate","multiline","data","tooltip","grouped","color","pattern","fit","json","keys","legend","show","name","a","b","c","d","categories","stacked","groups","l","len3","appendTo","bindto","generate","detach","remove","append","html","C3 - Line Chart","C3 - Bar Chart","C3 - Stacked Bar Chart","C3 - Area Chart","C3 - Scatter Chart","call","this"],"mappings":"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","file":"c3_renderers.min.js","sourcesContent":["###\n    Data Analytics Toolkit: Explore any data avaialable through a REST service \n    Copyright (C) 2016  Scott Aslan\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as\n    published by the Free Software Foundation, either version 3 of the\n    License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/agpl.html>.\n###\ncallWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\"), require(\"c3\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\", \"c3\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery, c3\n        \ncallWithJQuery ($, c3) ->\n\n    makeC3Chart = (chartOpts = {}) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n            c3: {}\n\n        opts = $.extend true, defaults, opts\n        opts.c3.size ?= {}\n        opts.c3.size.width ?= window.innerWidth / 1.4\n        opts.c3.size.height ?= window.innerHeight / 1.4 - 50\n        chartOpts.type ?= \"line\"\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in colKeys)\n        rotationAngle = 0\n\n        fullAggName = pivotData.aggregatorName \n        if pivotData.valAttrs.length\n            fullAggName += \"(#{pivotData.valAttrs.join(\", \")})\"\n\n        if chartOpts.type == \"scatter\"\n            dataArray = []\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n            vAxisTitle = pivotData.rowAttrs.join(\"-\")\n            for y, tree2 of pivotData.tree\n                for x, agg of tree2\n                    datum = {}\n                    datum[hAxisTitle] = parseFloat(x)\n                    datum[vAxisTitle] = parseFloat(y)\n                    datum[\"tooltip\"] = agg.format(agg.value())\n                    dataArray.push datum\n        else\n            numCharsInHAxis = 0\n            for x in headers\n                numCharsInHAxis += x.length\n            if numCharsInHAxis > 50\n                rotationAngle = 45\n\n            columns = []\n            for rowKey in rowKeys\n                rowHeader = rowKey.join(\"-\")\n                row = [if rowHeader == \"\" then pivotData.aggregatorName else rowHeader]\n                for colKey in colKeys\n                    val = parseFloat  pivotData.getAggregator(rowKey, colKey).value()\n                    if isFinite(val)\n                        if val < 1\n                            row.push val.toPrecision(3)\n                        else\n                            row.push val.toFixed(3)\n                    else\n                        row.push null\n                columns.push row\n\n            vAxisTitle = pivotData.aggregatorName+ \n                if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n            hAxisTitle = pivotData.colAttrs.join(\"-\")\n\n        titleText = fullAggName\n        titleText += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n        groupByTitle = pivotData.rowAttrs.join(\"-\")\n        titleText += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n        title = $(\"<p>\", {style: \"text-align: center; font-weight: bold\"})\n        title.text(titleText)\n\n        params = \n            axis: \n                y:\n                    label: vAxisTitle\n                x:\n                    label: hAxisTitle\n                    tick:\n                        rotate: rotationAngle\n                        multiline: false\n            data: \n                type: chartOpts.type\n            tooltip:\n                grouped: false\n            color: \n                pattern: [ \"#3366cc\", \"#dc3912\", \"#ff9900\", \"#109618\",\n                           \"#990099\", \"#0099c6\", \"#dd4477\", \"#66aa00\",\n                           \"#b82e2e\", \"#316395\", \"#994499\", \"#22aa99\",\n                           \"#aaaa11\", \"#6633cc\", \"#e67300\", \"#8b0707\",\n                           \"#651067\", \"#329262\", \"#5574a6\", \"#3b3eac\" ]\n\n\n        $.extend params, opts.c3\n\n        if chartOpts.type == \"scatter\"\n            params.data.x = hAxisTitle\n            params.axis.x.tick = fit: false\n            params.data.json = dataArray\n            params.data.keys = value: [hAxisTitle,vAxisTitle]\n            params.legend = show: false \n            params.tooltip.format =  \n                title: -> fullAggName\n                name: -> \"\"\n                value: (a,b,c,d) -> dataArray[d].tooltip\n        else\n            params.axis.x.type= 'category'\n            params.axis.x.categories = headers\n            params.data.columns = columns\n\n\n        if chartOpts.stacked?\n            params.data.groups = [x.join(\"-\") for x in rowKeys]\n        renderArea = $(\"<div>\", style: \"display:none;\").appendTo $(\"body\")\n        result = $(\"<div>\").appendTo renderArea\n        params.bindto = result[0]\n        c3.generate params\n        result.detach()\n        renderArea.remove()\n        $(\"<div>\").append title, result\n        return returnObject = \n                html: result\n\n    c3_renderers = \n        \"C3 - Line Chart\": makeC3Chart()\n        \"C3 - Bar Chart\": makeC3Chart(type: \"bar\")\n        \"C3 - Stacked Bar Chart\": makeC3Chart(type: \"bar\", stacked: true)\n        \"C3 - Area Chart\": makeC3Chart(type: \"area\", stacked: true)\n        \"C3 - Scatter Chart\": makeC3Chart(type: \"scatter\")\n","\n/*\n    Data Analytics Toolkit: Explore any data avaialable through a REST service \n    Copyright (C) 2016  Scott Aslan\n\n    This program is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Affero General Public License as\n    published by the Free Software Foundation, either version 3 of the\n    License, or (at your option) any later version.\n\n    This program is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Affero General Public License for more details.\n\n    You should have received a copy of the GNU Affero General Public License\n    along with this program.  If not, see <http://www.gnu.org/licenses/agpl.html>.\n */\n\n(function() {\n  var callWithJQuery;\n\n  callWithJQuery = function(pivotModule) {\n    if (typeof exports === \"object\" && typeof module === \"object\") {\n      return pivotModule(require(\"jquery\"), require(\"c3\"));\n    } else if (typeof define === \"function\" && define.amd) {\n      return define([\"jquery\", \"c3\"], pivotModule);\n    } else {\n      return pivotModule(jQuery, c3);\n    }\n  };\n\n  callWithJQuery(function($, c3) {\n    var c3_renderers, makeC3Chart;\n    makeC3Chart = function(chartOpts) {\n      if (chartOpts == null) {\n        chartOpts = {};\n      }\n      return function(pivotData, opts) {\n        var agg, base, base1, base2, colKey, colKeys, columns, dataArray, datum, defaults, fullAggName, groupByTitle, h, hAxisTitle, headers, i, j, k, len, len1, len2, numCharsInHAxis, params, ref, renderArea, result, returnObject, rotationAngle, row, rowHeader, rowKey, rowKeys, title, titleText, tree2, vAxisTitle, val, x, y;\n        defaults = {\n          localeStrings: {\n            vs: \"vs\",\n            by: \"by\"\n          },\n          c3: {}\n        };\n        opts = $.extend(true, defaults, opts);\n        if ((base = opts.c3).size == null) {\n          base.size = {};\n        }\n        if ((base1 = opts.c3.size).width == null) {\n          base1.width = window.innerWidth / 1.4;\n        }\n        if ((base2 = opts.c3.size).height == null) {\n          base2.height = window.innerHeight / 1.4 - 50;\n        }\n        if (chartOpts.type == null) {\n          chartOpts.type = \"line\";\n        }\n        rowKeys = pivotData.getRowKeys();\n        if (rowKeys.length === 0) {\n          rowKeys.push([]);\n        }\n        colKeys = pivotData.getColKeys();\n        if (colKeys.length === 0) {\n          colKeys.push([]);\n        }\n        headers = (function() {\n          var i, len, results;\n          results = [];\n          for (i = 0, len = colKeys.length; i < len; i++) {\n            h = colKeys[i];\n            results.push(h.join(\"-\"));\n          }\n          return results;\n        })();\n        rotationAngle = 0;\n        fullAggName = pivotData.aggregatorName;\n        if (pivotData.valAttrs.length) {\n          fullAggName += \"(\" + (pivotData.valAttrs.join(\", \")) + \")\";\n        }\n        if (chartOpts.type === \"scatter\") {\n          dataArray = [];\n          hAxisTitle = pivotData.colAttrs.join(\"-\");\n          vAxisTitle = pivotData.rowAttrs.join(\"-\");\n          ref = pivotData.tree;\n          for (y in ref) {\n            tree2 = ref[y];\n            for (x in tree2) {\n              agg = tree2[x];\n              datum = {};\n              datum[hAxisTitle] = parseFloat(x);\n              datum[vAxisTitle] = parseFloat(y);\n              datum[\"tooltip\"] = agg.format(agg.value());\n              dataArray.push(datum);\n            }\n          }\n        } else {\n          numCharsInHAxis = 0;\n          for (i = 0, len = headers.length; i < len; i++) {\n            x = headers[i];\n            numCharsInHAxis += x.length;\n          }\n          if (numCharsInHAxis > 50) {\n            rotationAngle = 45;\n          }\n          columns = [];\n          for (j = 0, len1 = rowKeys.length; j < len1; j++) {\n            rowKey = rowKeys[j];\n            rowHeader = rowKey.join(\"-\");\n            row = [rowHeader === \"\" ? pivotData.aggregatorName : rowHeader];\n            for (k = 0, len2 = colKeys.length; k < len2; k++) {\n              colKey = colKeys[k];\n              val = parseFloat(pivotData.getAggregator(rowKey, colKey).value());\n              if (isFinite(val)) {\n                if (val < 1) {\n                  row.push(val.toPrecision(3));\n                } else {\n                  row.push(val.toFixed(3));\n                }\n              } else {\n                row.push(null);\n              }\n            }\n            columns.push(row);\n          }\n          vAxisTitle = pivotData.aggregatorName + (pivotData.valAttrs.length ? \"(\" + (pivotData.valAttrs.join(\", \")) + \")\" : \"\");\n          hAxisTitle = pivotData.colAttrs.join(\"-\");\n        }\n        titleText = fullAggName;\n        if (hAxisTitle !== \"\") {\n          titleText += \" \" + opts.localeStrings.vs + \" \" + hAxisTitle;\n        }\n        groupByTitle = pivotData.rowAttrs.join(\"-\");\n        if (groupByTitle !== \"\") {\n          titleText += \" \" + opts.localeStrings.by + \" \" + groupByTitle;\n        }\n        title = $(\"<p>\", {\n          style: \"text-align: center; font-weight: bold\"\n        });\n        title.text(titleText);\n        params = {\n          axis: {\n            y: {\n              label: vAxisTitle\n            },\n            x: {\n              label: hAxisTitle,\n              tick: {\n                rotate: rotationAngle,\n                multiline: false\n              }\n            }\n          },\n          data: {\n            type: chartOpts.type\n          },\n          tooltip: {\n            grouped: false\n          },\n          color: {\n            pattern: [\"#3366cc\", \"#dc3912\", \"#ff9900\", \"#109618\", \"#990099\", \"#0099c6\", \"#dd4477\", \"#66aa00\", \"#b82e2e\", \"#316395\", \"#994499\", \"#22aa99\", \"#aaaa11\", \"#6633cc\", \"#e67300\", \"#8b0707\", \"#651067\", \"#329262\", \"#5574a6\", \"#3b3eac\"]\n          }\n        };\n        $.extend(params, opts.c3);\n        if (chartOpts.type === \"scatter\") {\n          params.data.x = hAxisTitle;\n          params.axis.x.tick = {\n            fit: false\n          };\n          params.data.json = dataArray;\n          params.data.keys = {\n            value: [hAxisTitle, vAxisTitle]\n          };\n          params.legend = {\n            show: false\n          };\n          params.tooltip.format = {\n            title: function() {\n              return fullAggName;\n            },\n            name: function() {\n              return \"\";\n            },\n            value: function(a, b, c, d) {\n              return dataArray[d].tooltip;\n            }\n          };\n        } else {\n          params.axis.x.type = 'category';\n          params.axis.x.categories = headers;\n          params.data.columns = columns;\n        }\n        if (chartOpts.stacked != null) {\n          params.data.groups = [\n            (function() {\n              var l, len3, results;\n              results = [];\n              for (l = 0, len3 = rowKeys.length; l < len3; l++) {\n                x = rowKeys[l];\n                results.push(x.join(\"-\"));\n              }\n              return results;\n            })()\n          ];\n        }\n        renderArea = $(\"<div>\", {\n          style: \"display:none;\"\n        }).appendTo($(\"body\"));\n        result = $(\"<div>\").appendTo(renderArea);\n        params.bindto = result[0];\n        c3.generate(params);\n        result.detach();\n        renderArea.remove();\n        $(\"<div>\").append(title, result);\n        return returnObject = {\n          html: result\n        };\n      };\n    };\n    return c3_renderers = {\n      \"C3 - Line Chart\": makeC3Chart(),\n      \"C3 - Bar Chart\": makeC3Chart({\n        type: \"bar\"\n      }),\n      \"C3 - Stacked Bar Chart\": makeC3Chart({\n        type: \"bar\",\n        stacked: true\n      }),\n      \"C3 - Area Chart\": makeC3Chart({\n        type: \"area\",\n        stacked: true\n      }),\n      \"C3 - Scatter Chart\": makeC3Chart({\n        type: \"scatter\"\n      })\n    };\n  });\n\n}).call(this);\n\n//# sourceMappingURL=c3_renderers.js.map\n"],"sourceRoot":"/source/"}