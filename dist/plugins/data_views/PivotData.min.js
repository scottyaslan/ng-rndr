(function(){var a;(a=function(a){return"object"==typeof exports&&"object"==typeof module?a(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],a):(void 0===window.ngRNDR&&(window.ngRNDR={},void 0===window.ngRNDR.plugins&&(window.ngRNDR.plugins={},void 0===window.ngRNDR.plugins.dataViews&&(window.ngRNDR.plugins.dataViews={}))),window.ngRNDR.plugins.DataViews.PivotData=a(jQuery,d3),window.ngRNDR.plugins.dataViews)})(function(a){function b(a,b){this.meta=b.meta,this.dataUtils=b.dataUtils,this.aggregator=b.aggregator,a=b.dataUtils.convertToArray(a),this.filter=function(a){var b,c;for(var d in this.meta.attributeFilterExclusions)if(b=this.meta.attributeFilterExclusions[d],c=""+a[d],this.dataUtils.indexOf.call(b,c)>=0)return!1;return!0},this.sorted=!1,this.sorters=function(){},this.axisValues={},this.shownAttributes=[],this.attributeFilterInclusions=[],this.attributesAvailableForRowsAndCols=[],this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.allTotal=this.aggregator(this,[],[]),this.colAttrs=this.meta.cols,this.rowAttrs=this.meta.rows,this.availableAttributes=this.rowAttrs.concat(this.colAttrs),this.tblCols=function(b){var c,d;c=a[0],d=[];for(var e in c)b.dataUtils.hasProp.call(c,e)&&d.push(e);return d}(this);for(var c=0,d=this.tblCols.length;c<d;c++){var e=this.tblCols[c];this.axisValues[e]={}}this.shownAttributes=function(a){var b,c,d;d=[];for(var c=0,b=a.tblCols.length;c<b;c++){var e=a.tblCols[c];a.dataUtils.indexOf.call(a.meta.hiddenAttributes,e)<0&&d.push(e)}return d}(this),this.attributesAvailableForRowsAndCols.length+this.meta.rows.length+this.meta.cols.length!==this.shownAttributes.length&&(this.attributesAvailableForRowsAndCols=this.shownAttributes),this.dataUtils.forEachRecord(a,b.derivedAttributes,function(a){return function(b){var c,d,e;d=[];for(var f in b)a.dataUtils.hasProp.call(b,f)&&(e=b[f],null==e&&(e="null"),null==(c=a.axisValues[f])[e]&&(c[e]=0),d.push(a.axisValues[f][e]++));return d}}(this)),this.dataUtils.forEachRecord(a,b.derivedAttributes,function(a){return function(b){if(a.filter(b))return a.processRecord(b)}}(this))}return b.prototype={constructor:b,arrSort:function(a){var b,c;return c=function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this.dataUtils.getSort(this.sorters,b));return e}.call(this),function(a,b){var d,e,f;for(e in c)if(f=c[e],d=f(a[e],b[e]),0!==d)return d;return 0}},sortKeys:function(){this.sorted||(this.sorted=!0,this.rowKeys.sort(this.arrSort(this.rowAttrs)),this.colKeys.sort(this.arrSort(this.colAttrs)))},getColKeys:function(){return this.sortKeys(),this.colKeys},getRowKeys:function(){return this.sortKeys(),this.rowKeys},processRecord:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(b=[],m=[],i=this.colAttrs,e=0,f=i.length;e<f;e++)n=i[e],b.push(null!=(j=a[n])?j:"null");for(k=this.rowAttrs,h=0,g=k.length;h<g;h++)n=k[h],m.push(null!=(l=a[n])?l:"null");if(d=m.join(String.fromCharCode(0)),c=b.join(String.fromCharCode(0)),this.allTotal.push(a),0!==m.length&&(this.rowTotals[d]||(this.rowKeys.push(m),this.rowTotals[d]=this.aggregator(this,m,[])),this.rowTotals[d].push(a)),0!==b.length&&(this.colTotals[c]||(this.colKeys.push(b),this.colTotals[c]=this.aggregator(this,[],b)),this.colTotals[c].push(a)),0!==b.length&&0!==m.length)return this.tree[d]||(this.tree[d]={}),this.tree[d][c]||(this.tree[d][c]=this.aggregator(this,m,b)),this.tree[d][c].push(a)},getAggregator:function(a,b){var c,d,e;return e=a.join(String.fromCharCode(0)),d=b.join(String.fromCharCode(0)),c=0===a.length&&0===b.length?this.allTotal:0===a.length?this.colTotals[d]:0===b.length?this.rowTotals[e]:this.tree[e][d],null!=c?c:{value:function(){return null},format:function(){return""}}},isExcluded:function(a,b){var c=this;return void 0===c.meta.attributeFilterExclusions[a]||!(c.meta.attributeFilterExclusions[a].indexOf(b)>=0)},addExclusionFilter:function(a,b){var c=this;if(void 0!==c.meta.attributeFilterExclusions[a]){var d=c.meta.attributeFilterExclusions[a].indexOf(b);d>=0?c.meta.attributeFilterExclusions[a].splice(d,1):c.meta.attributeFilterExclusions[a].push(b)}else c.meta.attributeFilterExclusions[a]=[],c.meta.attributeFilterExclusions[a].push(b);c.attributeFilterInclusions[a]=[],angular.forEach(c.axisValues[a],function(b,d){c.meta.attributeFilterExclusions[a].indexOf(d)<0&&c.attributeFilterInclusions[a].push(d)})},addInclusionFilter:function(a,b){var c=this;c.attributeFilterInclusions[a]=[],c.meta.attributeFilterExclusions[a]=[],c.addExclusionFilter(a,b);var d=c.attributeFilterInclusions[a];c.attributeFilterInclusions[a]=c.meta.attributeFilterExclusions[a],c.meta.attributeFilterExclusions[a]=d},initializeAggregator:function(a){var b=a.aggregate([])([]).numInputs;void 0===b?this.meta.aggInputAttributeName=new Array:this.meta.aggInputAttributeName.length!==b&&(this.meta.aggInputAttributeName=new Array(b))}},b})}).call(this);
//# sourceMappingURL=PivotData.min.js.map