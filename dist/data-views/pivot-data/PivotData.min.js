!function(a,b){"function"==typeof define&&define.amd?define(["jquery","rndr"],function(c,d){return b(a,c,d)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("rndr")):b(a.$,a.rndr)}(this,function(a,b,c){function d(a,c){this.data=this.convertToArray(a),this.meta=c.meta||{rows:[],cols:[],hiddenAttributes:[],attributeFilterExclusions:{}},this.aggregator=c.aggregator.aggregate(c.aggregator.aggInputAttributeName),this.sorters=c.sorters,this.attributeFilterInclusions=[],this.attributesAvailableForRowsAndCols=[],this.tree={},this.rowKeys=[],this.colKeys=[],this.rowTotals={},this.colTotals={},this.axisValues={},this.allTotal=this.aggregator(this,[],[]),this.colAttrs=this.meta.cols,this.rowAttrs=this.meta.rows,this.availableAttributes=this.rowAttrs.concat(this.colAttrs),this.tblCols=function(a){var b,c;b=a.data[0],c=[];for(var d in b)b.hasOwnProperty(d)&&c.push(d);return c}(this);for(var d=0,e=this.tblCols.length;d<e;d++){var f=this.tblCols[d];this.axisValues[f]={}}this.shownAttributes=[],this.shownAttributes=function(a){var b,c,d;d=[];for(var c=0,b=a.tblCols.length;c<b;c++){var e=a.tblCols[c];a.meta.hiddenAttributes.indexOf(e)<0&&d.push(e)}return d}(this),this.attributesAvailableForRowsAndCols=b(this.shownAttributes).not(this.meta.rows).not(this.meta.cols).get(),this.forEachRecord(this.data,c.derivedAttributes,function(a){return function(b){var c,d,e;d=[];for(var f in b)b.hasOwnProperty(f)&&(e=b[f],null==e&&(e="null"),null==(c=a.axisValues[f])[e]&&(c[e]=0),d.push(a.axisValues[f][e]++));a.filter(b)&&a.processRecord(b)}}(this)),this.dirty=!1}var e=function(a,b){var c,d,e,f,g,h,i;if(h=/(\d+)|(\D+)/g,g=/\d/,i=/^0/,"number"==typeof a||"number"==typeof b)return isNaN(a)?1:isNaN(b)?-1:a-b;if(c=String(a).toLowerCase(),e=String(b).toLowerCase(),c===e)return 0;if(!g.test(c)||!g.test(e))return c>e?1:-1;for(c=c.match(h),e=e.match(h);c.length&&e.length;)if(d=c.shift(),f=e.shift(),d!==f)return g.test(d)&&g.test(f)?d.replace(i,".0")-f.replace(i,".0"):d>f?1:-1;return c.length-e.length};d.prototype={constructor:d,arrSort:function(a){var b,c;return c=function(){var c,d,e;for(e=[],c=0,d=a.length;c<d;c++)b=a[c],e.push(this.getSort(this.sorters,b));return e}.call(this),function(a,b){var d,e,f;for(e in c)if(f=c[e],d=f(a[e],b[e]),0!==d)return d;return 0}},sortKeys:function(){this.rowKeys.sort(this.arrSort(this.rowAttrs)),this.colKeys.sort(this.arrSort(this.colAttrs))},getColKeys:function(){return this.sortKeys(),this.colKeys},getRowKeys:function(){return this.sortKeys(),this.rowKeys},filter:function(a){var b,c;for(var d in this.meta.attributeFilterExclusions)if(b=this.meta.attributeFilterExclusions[d],c=""+a[d],b.indexOf(c)>=0)return!1;return!0},processRecord:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;for(b=[],m=[],i=this.colAttrs,e=0,f=i.length;e<f;e++)n=i[e],b.push(null!=(j=a[n])?j:"null");for(k=this.rowAttrs,h=0,g=k.length;h<g;h++)n=k[h],m.push(null!=(l=a[n])?l:"null");if(d=m.join(String.fromCharCode(0)),c=b.join(String.fromCharCode(0)),this.allTotal.push(a),0!==m.length&&(this.rowTotals[d]||(this.rowKeys.push(m),this.rowTotals[d]=this.aggregator(this,m,[])),this.rowTotals[d].push(a)),0!==b.length&&(this.colTotals[c]||(this.colKeys.push(b),this.colTotals[c]=this.aggregator(this,[],b)),this.colTotals[c].push(a)),0!==b.length&&0!==m.length)return this.tree[d]||(this.tree[d]={}),this.tree[d][c]||(this.tree[d][c]=this.aggregator(this,m,b)),this.tree[d][c].push(a)},getAggregator:function(a,b){var c,d,e;return e=a.join(String.fromCharCode(0)),d=b.join(String.fromCharCode(0)),c=0===a.length&&0===b.length?this.allTotal:0===a.length?this.colTotals[d]:0===b.length?this.rowTotals[e]:this.tree[e][d],null!=c?c:{value:function(){return null},format:function(){return""}}},addExclusionFilter:function(a,b){var c=this;if(void 0!==c.meta.attributeFilterExclusions[a]){var d=c.meta.attributeFilterExclusions[a].indexOf(b);d<0?c.meta.attributeFilterExclusions[a].push(b):c.removeExclusionFilter(a,b)}else c.meta.attributeFilterExclusions[a]=[],c.meta.attributeFilterExclusions[a].push(b);c.dirty=!0},removeExclusionFilter:function(a,b){var c=this;if(void 0!==c.meta.attributeFilterExclusions[a]){var d=c.meta.attributeFilterExclusions[a].indexOf(b);d>=0&&c.meta.attributeFilterExclusions[a].splice(d,1)}c.dirty=!0},resetExclusionFilter:function(a){var b=this;void 0!==b.meta.attributeFilterExclusions[a]?b.meta.attributeFilterExclusions[a]=[]:b.meta.attributeFilterExclusions=[],b.dirty=!0},convertToArray:function(a){var b,c=this;return b=[],c.forEachRecord(a,{},function(a){return b.push(a)}),b},forEachRecord:function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(e=b.isEmptyObject(c)?d:function(a){var b,e,f;for(b in c)f=c[b],a[b]=null!=(e=f(a))?e:a[b];return d(a)},b.isFunction(a))return a(e);if(b.isArray(a)){if(b.isArray(a[0])){n=[];for(g in a)if(a.hasOwnProperty(g)&&(f=a[g],g>0)){l={},m=a[0];for(h in m)m.hasOwnProperty(h)&&(i=m[h],l[i]=f[h]);n.push(e(l))}return n}for(o=[],j=0,k=a.length;j<k;j++)l=a[j],o.push(e(l));return o}if(a instanceof jQuery)return p=[],b("thead > tr > th",a).each(function(a){return p.push(b(this).text())}),b("tbody > tr",a).each(function(a){return l={},b("td",this).each(function(a){return l[p[a]]=b(this).html()}),e(l)});throw new Error("unknown input format")},getSort:function(a,c){var d;if(null!=a)if(b.isFunction(a)){if(d=a(c),b.isFunction(d))return d}else if(null!=a[c])return a[c];return e}},c.plugins.dataViews.set("PivotData",{view:d,opts:{}})});
//# sourceMappingURL=PivotData.min.js.map