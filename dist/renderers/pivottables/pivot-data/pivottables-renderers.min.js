!function(a,b){"function"==typeof define&&define.amd?define(["jquery","rndr"],function(a,c){return b(a,c)}):"object"==typeof module&&module.exports?module.exports=b(require("jquery"),require("rndr")):b(a.$,a.rndr)}(this,function(a,b){var c=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;i={clazz:["pvtTable"],locales:{en:{localeStrings:{totals:"Totals"}}}},c=a.extend(!0,i,c),f=b.dataView.colAttrs,n=b.dataView.rowAttrs,p=b.dataView.getRowKeys(),h=b.dataView.getColKeys(),m=document.createElement("table"),a(m).width(c.width+c.widthOffset+"px"),a(m).height(c.height+c.heightOffset+"px"),m.className=c.clazz.join(" "),v=document.createElement("thead"),r=document.createElement("tbody"),t=document.createElement("tfoot"),q=function(a,b,c){var d,e,f,g,h,i,j,k;if(0!==b){for(g=!0,k=d=0,h=c;0<=h?d<=h:d>=h;k=0<=h?++d:--d)a[b-1][k]!==a[b][k]&&(g=!1);if(g)return-1}for(f=0;b+f<a.length;){for(j=!1,k=e=0,i=c;0<=i?e<=i:e>=i;k=0<=i?++e:--e)a[b][k]!==a[b+f][k]&&(j=!0);if(j)break;f++}return f};for(k in f)if(f.hasOwnProperty(k)){e=f[k],x=document.createElement("tr"),0===parseInt(k)&&0!==n.length&&(u=document.createElement("th"),u.setAttribute("colspan",n.length),u.setAttribute("rowspan",f.length),x.appendChild(u)),u=document.createElement("th"),u.className="pvtAxisLabel",a(u).css("white-space","nowrap"),u.innerHTML=e,x.appendChild(u);for(j in h)h.hasOwnProperty(j)&&(g=h[j],A=q(h,parseInt(j),parseInt(k)),A!==-1&&(u=document.createElement("th"),a(u).off("dblclick").on("dblclick",function(d){var e=a(d.currentTarget).html(),f=b.dataView.meta.cols[a(d.currentTarget).parent().parent().children().index(a(d.currentTarget).parent())];b.dataView.addInclusionFilter(f,e),b.draw(c.element,b.dataView.data)}),u.className="pvtColLabel",u.innerHTML=g[k],u.setAttribute("colspan",A),parseInt(k)===f.length-1&&0!==n.length&&u.setAttribute("rowspan",2),x.appendChild(u)));0===parseInt(k)&&(u=document.createElement("th"),u.className="pvtTotalLabel pvtRowTotalLabel",u.innerHTML=c.locales[b.locale].localeStrings.totals,u.setAttribute("rowspan",f.length+(0===n.length?0:1)),x.appendChild(u)),v.appendChild(x)}if(0!==n.length){x=document.createElement("tr");for(j in n)n.hasOwnProperty(j)&&(l=n[j],u=document.createElement("th"),a(u).css("white-space","nowrap"),u.className="pvtAxisLabel",u.innerHTML=l,x.appendChild(u));u=document.createElement("th"),0===f.length&&(u.className="pvtTotalLabel pvtRowTotalLabel",u.innerHTML=c.locales[b.locale].localeStrings.totals),x.appendChild(u),v.appendChild(x)}for(j in p)if(p.hasOwnProperty(j)){o=p[j],x=document.createElement("tr");for(k in o)o.hasOwnProperty(k)&&(y=o[k],u=document.createElement("th"),a(u).css("white-space","nowrap"),a(u).off("dblclick").on("dblclick",function(d){var e=a(d.currentTarget).html(),f=b.dataView.meta.rows[a(d.currentTarget).parent().children().index(a(d.currentTarget))];a.each(b.dataView.axisValues[f],function(a,c){a!=e&&b.dataView.addExclusionFilter(f,a)}),b.draw(c.element,b.dataView.data)}),u.className="pvtRowLabel",u.innerHTML=y,x.appendChild(u),parseInt(k)===n.length-1&&0!==f.length&&x.appendChild(document.createElement("th")));for(k in h)h.hasOwnProperty(k)&&(g=h[k],d=b.dataView.getAggregator(o,g),z=d.value(),s=document.createElement("td"),s.className="pvtVal row"+j+" col"+k,s.innerHTML=d.format(z),s.setAttribute("data-value",z),a(s).off("dblclick").on("dblclick",function(a){}),x.appendChild(s));w=b.dataView.getAggregator(o,[]),z=w.value(),s=document.createElement("td"),s.className="pvtTotal rowTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),s.setAttribute("data-for","row"+j),x.appendChild(s),r.appendChild(x)}x=document.createElement("tr"),u=document.createElement("th"),u.className="pvtTotalLabel pvtColTotalLabel",u.innerHTML=c.locales[b.locale].localeStrings.totals,u.setAttribute("colspan",n.length+(0===f.length?0:1)),x.appendChild(u);for(k in h)h.hasOwnProperty(k)&&(g=h[k],w=b.dataView.getAggregator([],g),z=w.value(),s=document.createElement("td"),s.className="pvtTotal colTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),s.setAttribute("data-for","col"+k),x.appendChild(s));return w=b.dataView.getAggregator([],[]),z=w.value(),s=document.createElement("td"),s.className="pvtGrandTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),x.appendChild(s),m.appendChild(v),m.appendChild(r),t.appendChild(x),m.appendChild(t),m.setAttribute("data-numrows",p.length),m.setAttribute("data-numcols",h.length),m.setAttribute("data-numcolattrs",f.length),m.setAttribute("data-numrowattrs",n.length),m},d=function(b,c){return c.element.empty(),c.element.append(b),a(b)},e=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o;switch(null==c&&(c="heatmap"),l=a(b).data("numrows"),k=a(b).data("numcols"),e=null!=d&&null!=(m=d.heatmap)?m.colorScaleGenerator:void 0,null==e&&(e=function(a){var b,c;return c=Math.min.apply(Math,a),b=Math.max.apply(Math,a),function(a){var d;return d=b===c?0:255-Math.round(255*(a-c)/(b-c)),"rgb(255,"+d+","+d+")"}}),f=function(b){return function(c){var d,f,g;return f=function(d){return b.find(c).each(function(){var b;if(b=a(this).data("value"),null!=b&&isFinite(b))return d(b,a(this))})},g=[],f(function(a){return g.push(a)}),d=e(g),f(function(a,b){return b.css("background-color",d(a))})}}(a(b)),c){case"heatmap":f(".pvtVal");break;case"rowheatmap":for(g=i=0,n=l;0<=n?i<n:i>n;g=0<=n?++i:--i)f(".pvtVal.row"+g);break;case"colheatmap":for(h=j=0,o=k;0<=o?j<o:j>o;h=0<=o?++j:--j)f(".pvtVal.col"+h)}return f(".pvtTotal.rowTotal"),f(".pvtTotal.colTotal"),a(b)},f=function(b){var c,d,e,f,g,h;for(g=a(b).data("numrows"),f=a(b).data("numcols"),c=function(b){return function(c){var d,e,f,g,h,i;return d=function(d){return b.find(c).each(function(){var b;if(b=a(this).data("value"),null!=b&&isFinite(b))return d(b,a(this))})},i=[],d(function(a){return i.push(a)}),e=Math.max.apply(Math,i),e<0&&(e=0),g=e,f=Math.min.apply(Math,i),f<0&&(g=e-f),h=function(a){return 100*a/(1.4*g)},d(function(b,c){var d,e,g,i;return g=c.text(),i=a("<div>").css({position:"relative",height:"55px"}),e="gray",d=0,f<0&&(d=h(-f)),b<0&&(d+=h(b),e="darkred",b=-b),i.append(a("<div>").css({position:"absolute",bottom:d+"%",left:0,right:0,height:h(b)+"%","background-color":e})),i.append(a("<div>").text(g).css({position:"relative","padding-left":"5px","padding-right":"5px"})),c.css({padding:0,"padding-top":"5px","text-align":"center"}).html(i)})}}(a(b)),d=e=0,h=g;0<=h?e<h:e>h;d=0<=h?++e:--e)c(".pvtVal.row"+d);return c(".pvtTotal.colTotal"),a(b)},g={"Pivot Table - Table":function(a,b){return d(c(a,b),b)},"Pivot Table - Table Barchart":function(a,b){return d(f(c(a,b)),b)},"Pivot Table - Heatmap":function(a,b){return d(e(c(a,b),"heatmap",b),b)},"Pivot Table - Row Heatmap":function(a,b){return d(e(c(a,b),"rowheatmap",b),b)},"Pivot Table - Col Heatmap":function(a,b){return d(e(c(a,b),"colheatmap",b),b)}};b.plugins.renderers.set("Pivot Table - Table",{render:g["Pivot Table - Table"],opts:{heightOffset:0},dataViewName:"PivotData"}),b.plugins.renderers.set("Pivot Table - Table Barchart",{render:g["Pivot Table - Table Barchart"],opts:{heightOffset:0},dataViewName:"PivotData"}),b.plugins.renderers.set("Pivot Table - Heatmap",{render:g["Pivot Table - Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"}),b.plugins.renderers.set("Pivot Table - Row Heatmap",{render:g["Pivot Table - Row Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"}),b.plugins.renderers.set("Pivot Table - Col Heatmap",{render:g["Pivot Table - Col Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"})});
//# sourceMappingURL=pivottables-renderers.min.js.map