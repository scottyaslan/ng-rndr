!function(a,b){"function"==typeof define&&define.amd?define(["jquery","rndr"],function(c,d){return b(a,c,d)}):"object"==typeof module&&module.exports?module.exports=b(a,require("jquery"),require("rndr")):b(a,a.$,a.rndr)}(this,function(a,b,c){var d=function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;i={clazz:["pvtTable"],locales:{en:{localeStrings:{totals:"Totals"}}}},c=b.extend(!0,i,c),f=a.dataView.colAttrs,n=a.dataView.rowAttrs,p=a.dataView.getRowKeys(),h=a.dataView.getColKeys(),m=document.createElement("table"),b(m).width(c.width+c.widthOffset+"px"),b(m).height(c.height+c.heightOffset+"px"),m.className=c.clazz.join(" "),v=document.createElement("thead"),r=document.createElement("tbody"),t=document.createElement("tfoot"),q=function(a,b,c){var d,e,f,g,h,i,j,k;if(0!==b){for(g=!0,k=d=0,h=c;0<=h?d<=h:d>=h;k=0<=h?++d:--d)a[b-1][k]!==a[b][k]&&(g=!1);if(g)return-1}for(f=0;b+f<a.length;){for(j=!1,k=e=0,i=c;0<=i?e<=i:e>=i;k=0<=i?++e:--e)a[b][k]!==a[b+f][k]&&(j=!0);if(j)break;f++}return f};for(k in f)if(f.hasOwnProperty(k)){e=f[k],x=document.createElement("tr"),0===parseInt(k)&&0!==n.length&&(u=document.createElement("th"),u.setAttribute("colspan",n.length),u.setAttribute("rowspan",f.length),x.appendChild(u)),u=document.createElement("th"),u.className="pvtAxisLabel",b(u).css("white-space","nowrap"),u.innerHTML=e,x.appendChild(u);for(j in h)h.hasOwnProperty(j)&&(g=h[j],A=q(h,parseInt(j),parseInt(k)),A!==-1&&(u=document.createElement("th"),b(u).off("dblclick").on("dblclick",function(d){var e=b(d.currentTarget).html(),f=a.dataView.meta.cols[b(d.currentTarget).parent().parent().children().index(b(d.currentTarget).parent())];a.dataView.addInclusionFilter(f,e),a.draw(c.element,a.dataView.data)}),u.className="pvtColLabel",u.innerHTML=g[k],u.setAttribute("colspan",A),parseInt(k)===f.length-1&&0!==n.length&&u.setAttribute("rowspan",2),x.appendChild(u)));0===parseInt(k)&&(u=document.createElement("th"),u.className="pvtTotalLabel",u.innerHTML=c.locales[a.locale].localeStrings.totals,u.setAttribute("rowspan",f.length+(0===n.length?0:1)),x.appendChild(u)),v.appendChild(x)}if(0!==n.length){x=document.createElement("tr");for(j in n)n.hasOwnProperty(j)&&(l=n[j],u=document.createElement("th"),b(u).css("white-space","nowrap"),u.className="pvtAxisLabel",u.innerHTML=l,x.appendChild(u));u=document.createElement("th"),0===f.length&&(u.className="pvtTotalLabel",u.innerHTML=c.locales[a.locale].localeStrings.totals),x.appendChild(u),v.appendChild(x)}for(j in p)if(p.hasOwnProperty(j)){o=p[j],x=document.createElement("tr");for(k in o)o.hasOwnProperty(k)&&(y=o[k],u=document.createElement("th"),b(u).css("white-space","nowrap"),b(u).off("dblclick").on("dblclick",function(d){var e=b(d.currentTarget).html(),f=a.dataView.meta.rows[b(d.currentTarget).parent().children().index(b(d.currentTarget))];b.each(a.dataView.axisValues[f],function(b,c){b!=e&&a.dataView.addExclusionFilter(f,b)}),a.draw(c.element,a.dataView.data)}),u.className="pvtRowLabel",u.innerHTML=y,x.appendChild(u),parseInt(k)===n.length-1&&0!==f.length&&x.appendChild(document.createElement("th")));for(k in h)h.hasOwnProperty(k)&&(g=h[k],d=a.dataView.getAggregator(o,g),z=d.value(),s=document.createElement("td"),s.className="pvtVal row"+j+" col"+k,s.innerHTML=d.format(z),s.setAttribute("data-value",z),b(s).off("dblclick").on("dblclick",function(a){}),x.appendChild(s));w=a.dataView.getAggregator(o,[]),z=w.value(),s=document.createElement("td"),s.className="pvtTotal rowTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),s.setAttribute("data-for","row"+j),x.appendChild(s),r.appendChild(x)}x=document.createElement("tr"),u=document.createElement("th"),u.className="pvtTotalLabel",u.innerHTML=c.locales[a.locale].localeStrings.totals,u.setAttribute("colspan",n.length+(0===f.length?0:1)),x.appendChild(u);for(k in h)h.hasOwnProperty(k)&&(g=h[k],w=a.dataView.getAggregator([],g),z=w.value(),s=document.createElement("td"),s.className="pvtTotal colTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),s.setAttribute("data-for","col"+k),x.appendChild(s));return w=a.dataView.getAggregator([],[]),z=w.value(),s=document.createElement("td"),s.className="pvtGrandTotal",s.innerHTML=w.format(z),s.setAttribute("data-value",z),x.appendChild(s),m.appendChild(v),m.appendChild(r),t.appendChild(x),m.appendChild(t),m.setAttribute("data-numrows",p.length),m.setAttribute("data-numcols",h.length),m.setAttribute("data-numcolattrs",f.length),m.setAttribute("data-numrowattrs",n.length),m},e=function(a,c){return c.element.empty(),c.element.append(a),b(a)},f=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o;switch(null==c&&(c="heatmap"),l=b(a).data("numrows"),k=b(a).data("numcols"),e=null!=d&&null!=(m=d.heatmap)?m.colorScaleGenerator:void 0,null==e&&(e=function(a){var b,c;return c=Math.min.apply(Math,a),b=Math.max.apply(Math,a),function(a){var d;return d=b===c?0:255-Math.round(255*(a-c)/(b-c)),"rgb(255,"+d+","+d+")"}}),f=function(a){return function(c){var d,f,g;return f=function(d){return a.find(c).each(function(){var a;if(a=b(this).data("value"),null!=a&&isFinite(a))return d(a,b(this))})},g=[],f(function(a){return g.push(a)}),d=e(g),f(function(a,b){return b.css("background-color",d(a))})}}(b(a)),c){case"heatmap":f(".pvtVal");break;case"rowheatmap":for(g=i=0,n=l;0<=n?i<n:i>n;g=0<=n?++i:--i)f(".pvtVal.row"+g);break;case"colheatmap":for(h=j=0,o=k;0<=o?j<o:j>o;h=0<=o?++j:--j)f(".pvtVal.col"+h)}return f(".pvtTotal.rowTotal"),f(".pvtTotal.colTotal"),b(a)},g=function(a){var c,d,e,f,g,h;for(g=b(a).data("numrows"),f=b(a).data("numcols"),c=function(a){return function(c){var d,e,f,g;return d=function(d){return a.find(c).each(function(){var a;if(a=b(this).data("value"),null!=a&&isFinite(a))return d(a,b(this))})},g=[],d(function(a){return g.push(a)}),e=Math.max.apply(Math,g),f=function(a){return 100*a/(1.4*e)},d(function(a,c){var d,e;return d=c.text(),e=b("<div>").css({position:"relative"}),e.append(b("<div>").css({position:"absolute",bottom:-2,left:0,right:0,height:f(a)+"%","background-color":"gray"})),e.append(b("<div>").text(d).css({position:"relative","padding-left":"5px","padding-right":"5px"})),c.css({padding:0,"padding-top":"5px","text-align":"center"}).html(e)})}}(b(a)),d=e=0,h=g;0<=h?e<h:e>h;d=0<=h?++e:--e)c(".pvtVal.row"+d);return c(".pvtTotal.colTotal"),b(a)},h={"Pivot Table - Table":function(a,b){return e(d(a,b),b)},"Pivot Table - Table Barchart":function(a,b){return e(g(d(a,b)),b)},"Pivot Table - Heatmap":function(a,b){return e(f(d(a,b),"heatmap",b),b)},"Pivot Table - Row Heatmap":function(a,b){return e(f(d(a,b),"rowheatmap",b),b)},"Pivot Table - Col Heatmap":function(a,b){return e(f(d(a,b),"colheatmap",b),b)}};c.plugins.renderers.set("Pivot Table - Table",{render:h["Pivot Table - Table"],opts:{heightOffset:0},dataViewName:"PivotData"}),c.plugins.renderers.set("Pivot Table - Table Barchart",{render:h["Pivot Table - Table Barchart"],opts:{heightOffset:0},dataViewName:"PivotData"}),c.plugins.renderers.set("Pivot Table - Heatmap",{render:h["Pivot Table - Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"}),c.plugins.renderers.set("Pivot Table - Row Heatmap",{render:h["Pivot Table - Row Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"}),c.plugins.renderers.set("Pivot Table - Col Heatmap",{render:h["Pivot Table - Col Heatmap"],opts:{heightOffset:0},dataViewName:"PivotData"})});
//# sourceMappingURL=pivottables-renderers.min.js.map