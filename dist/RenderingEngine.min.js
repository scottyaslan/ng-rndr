!function(a,b){define("rndrRenderingEngine",["jquery","$rndrFormatters","$rndrSorters","$rndrDerivedAttributes","$rndrAggregators","$rndrDataViews","$rndrRenderers"],function(c,d,e,f,g,h,i){return a.rndr.RenderingEngine=b(c,d,e,f,g,h,i)})}(this,function(a,b,c,d,e,f,g){"use strict";function h(a,c,d,e,h,j,k,l,m,n){if(void 0===m&&""===m&&null===m||(this.element=m),void 0!==n&&""!==n&&null!==n||(n=[]),void 0===c||""===c||null===c?this.id=i():this.id=c,void 0===a||""===a||null===a){var o=new Error("RenderingEngine constructor: cannot instantiate a RenderingEngine object without a renderer name.");throw"undefined"!=typeof console&&null!==console&&console.error(o.stack),o}this.renderer=a,void 0!==k&&""!==k&&null!==k?this.locale=k:this.locale="en",this.setAggregator(d,e),this.setDerivedAttributes(j),this.setSorters(l);var p=f.get(g.get(this.renderer).dataViewName).view;void 0!==h&&""!==h&&null!==h?this.dataView=new p(n,{aggregator:this.aggregator,derivedAttributes:this.derivedAttributes,sorters:this.sorters,formatters:b.map,meta:h}):this.dataView=new p(n,{aggregator:this.aggregator,derivedAttributes:this.derivedAttributes,sorters:this.sorters,formatters:b.map}),this.dirty=!1}var i=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})};return h.prototype={constructor:h,setRenderer:function(a){if(void 0===a||""===a||null===a){var b=new Error("Cannot configure a rendering engine without a renderer name.");throw"undefined"!=typeof console&&null!==console&&console.error(b.stack),b}this.renderer=a,this.dirty=!0},setLocale:function(a){void 0!==a&&""!==a&&null!==a?this.locale=a:this.locale="en",this.dirty=!0},setElement:function(a){void 0!==a&&""!==a&&null!==a&&(this.element=a),this.dirty=!0},setDerivedAttributes:function(b){this.derivedAttributes={},void 0!==b&&""!==b&&null!==b&&a.each(b,function(a){try{this.derivedAttributes[a]=d.map[a]}catch(c){var b=c;"undefined"!=typeof console&&null!==console&&console.log("The '"+a+"' derived attribute is not configured with the $rndrDerivedAttributes service. Stack Trace: "+b.stack)}}),this.dirty=!0},setSorters:function(b){this.sorters={},void 0!==b&&""!==b&&null!==b&&a.each(b,function(a){try{this.sorters[a]=c.map[a]}catch(c){var b=c;"undefined"!=typeof console&&null!==console&&console.log("The '"+a+"' sorter is not configured with the $rndrSorters service. Stack Trace: "+b.stack)}}),this.dirty=!0},setAggregator:function(a,b){try{void 0===this.aggregator&&(this.aggregator={name:"Count",aggregate:e.get("Count"),aggInputAttributeName:[]})}catch(a){var c=a;"undefined"!=typeof console&&null!==console&&console.log("The 'Count' aggregator is not configured with the $rndrAggregators service. Stack Trace: "+c.stack)}if(void 0===a||""===a||null===a){this.aggregator.name="Count";try{this.aggregator.aggregate=e.get("Count")}catch(a){var c=a;"undefined"!=typeof console&&null!==console&&console.log("The 'Count' aggregator is not configured with the $rndrAggregators service. Stack Trace: "+c.stack)}this.aggregator.aggInputAttributeName=[]}else{this.aggregator.name=a;try{this.aggregator.aggregate=e.get(a)}catch(a){var c=a;"undefined"!=typeof console&&null!==console&&console.log("The '"+name+"' aggregator is not configured with the rndr.aggregators module. Stack Trace: "+c.stack)}this.aggregator.aggInputAttributeName=[]}var d=e.get(this.aggregator.name)([])([]).numInputs;void 0===d?this.aggregator.aggInputAttributeName=new Array:this.aggregator.aggInputAttributeName.length!==d&&(this.aggregator.aggInputAttributeName=new Array(d)),void 0!==b&&""!==b&&null!==b&&(this.aggregator.aggInputAttributeName=b),this.dirty=!0},draw:function(h){var i=this;if(void 0===i.element&&""===i.element&&null===i.element){var j=new Error("RenderingEngine draw: cannot draw a RenderingEngine object without an HTML element container defined.");throw"undefined"!=typeof console&&null!==console&&console.error(j.stack),j}i.element.empty();var k=a("<div>").addClass("rndr-loader").css({top:(i.element.innerHeight()-60)/2,left:(i.element.innerWidth()-60)/2});return i.element.append(k),setTimeout(function(j){var k,l={aggregator:i.aggregator,derivedAttributes:i.derivedAttributes,sorters:i.sorters,formatters:b.map,meta:i.dataView.meta},m={element:i.element,renderers:g,dataViews:f,sorters:c.map,aggregators:e,derivedAttributes:d.map,formatters:b.map,heightOffset:0,widthOffset:0,locales:{en:{localeStrings:{renderError:"An error occurred rendering the results.",computeError:"An error occurred computing the results."}}},height:i.element.innerHeight(),width:i.element.innerWidth()};try{var n=f.get(g.get(i.renderer).dataViewName).view;i.dataView=new n(h,a.extend(l,f.get(g.get(i.renderer).dataViewName).opts));try{k=g.get(i.renderer).render(i,a.extend(m,g.get(i.renderer).opts))}catch(b){var o=b;"undefined"!=typeof console&&null!==console&&console.log(o.stack),i.element.empty(),i.element.append(a("<span>").html(m.locales[i.locale].localeStrings.renderError))}}catch(b){var o=b;"undefined"!=typeof console&&null!==console&&console.log(o.stack),i.element.empty(),i.element.append(a("<span>").html(m.locales[i.locale].localeStrings.computeError))}return i.dirty=!1,console.log(i.meta()),k},0,!0,{data:h})},isDirty:function(){return this.dirty||this.dataView.meta.dirty},meta:function(){var a={};a.renderer=this.renderer,a.id=this.id,a.locale=this.locale,a.dataView={},a.dataView.meta=this.dataView.meta,a.aggregator={name:this.aggregator.name,aggInputAttributeName:this.aggregator.aggInputAttributeName},a.derivedAttributes=[];for(var b in this.derivedAttributes)a.derivedAttributes.push(this.derivedAttributes[b]);a.sorters=[];for(var b in this.sorters)a.sorters.push(this.sorters[b]);return a}},h});
//# sourceMappingURL=RenderingEngine.min.js.map